components:
  schemas:
    ErrorResponse:
      type: object
      required: [success, code, message, traceId]
      properties:
        success:
          type: boolean
          example: false
        code:
          type: string
          description: Internal stable error code (machine-friendly).
          example: E_VALIDATION
        message:
          type: string
          description: Human-readable (i18n-ready) message.
          example: "الحقل email مطلوب"
        details:
          type: object
          additionalProperties: true
          description: Optional details such as field-level validation errors.
          example:
            field: "email"
            reason: "required"
        traceId:
          type: string
          description: Trace/Request id to correlate with logs/traces.
          example: "7e2d8f18b52ab71d"
        docsUrl:
          type: string
          description: Link to docs/runbook for the error code.
          example: "https://docs.kaleem-ai.com/errors#E_VALIDATION"
    RateLimitResponse:
      type: object
      required: [success, code, message, retryAfterSeconds]
      properties:
        success:
          type: boolean
          example: false
        code:
          type: string
          example: E_RATE_LIMITED
        message:
          type: string
          example: "Too many requests. Please try again later."
        retryAfterSeconds:
          type: integer
          example: 30
        traceId:
          type: string
          example: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
  responses:
    Error400:
      description: Bad Request (validation or malformed input)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Error401:
      description: Unauthorized (missing/invalid token)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Error403:
      description: Forbidden (insufficient role/permissions)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Error404:
      description: Not Found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Error409:
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Error429:
      description: Too Many Requests (rate limit exceeded)
      headers:
        Retry-After:
          description: Suggested seconds to wait before retrying.
          schema:
            type: integer
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/RateLimitResponse'
    Error500:
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
