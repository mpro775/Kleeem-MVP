# 🎭 اختبارات End-to-End (E2E) - Kaleem Frontend

## 📋 نظرة عامة

هذا المجلد يحتوي على اختبارات E2E شاملة لتطبيق Kaleem Frontend باستخدام Playwright. هذه الاختبارات تتحقق من أن جميع الميزات تعمل بشكل صحيح من وجهة نظر المستخدم النهائي.

## 🚀 الميزات

- **اختبارات شاملة**: تغطي جميع الميزات الرئيسية للتطبيق
- **اختبارات متعددة المتصفحات**: دعم Chrome، Firefox، Safari
- **اختبارات متعددة الأجهزة**: دعم الهواتف، الأجهزة اللوحية، أجهزة الكمبيوتر
- **اختبارات الأداء**: قياس أوقات التحميل والاستجابة
- **اختبارات إمكانية الوصول**: التحقق من توافق التطبيق مع معايير الوصول
- **اختبارات التصميم المتجاوب**: التحقق من عمل التطبيق على جميع أحجام الشاشات
- **اختبارات RTL**: التحقق من دعم اللغة العربية والتصميم من اليمين لليسار

## 📁 هيكل الملفات

```
tests/e2e/
├── README.md                    # هذا الملف
├── auth/                        # اختبارات المصادقة
│   ├── login.e2e.spec.ts       # اختبارات تسجيل الدخول
│   └── signup.e2e.spec.ts      # اختبارات التسجيل
├── home/                        # اختبارات الصفحة الرئيسية
│   └── home.e2e.spec.ts        # اختبارات الصفحة الرئيسية
├── navigation/                  # اختبارات التنقل
│   └── navigation.e2e.spec.ts  # اختبارات التنقل العام
├── products/                    # اختبارات المنتجات
│   └── products.e2e.spec.ts    # اختبارات صفحة المنتجات
└── cart/                        # اختبارات سلة التسوق
    └── cart.e2e.spec.ts        # اختبارات سلة التسوق
```

## 🛠️ المتطلبات

- Node.js 16+
- npm أو yarn
- Playwright (مثبت تلقائياً)

## 📦 التثبيت

```bash
# تثبيت Playwright
npm install -D @playwright/test

# تثبيت المتصفحات
npx playwright install
```

## 🚀 تشغيل الاختبارات

### تشغيل جميع الاختبارات
```bash
npm run e2e
```

### تشغيل اختبارات محددة
```bash
# تشغيل اختبارات المصادقة فقط
npx playwright test tests/e2e/auth/

# تشغيل اختبارات الصفحة الرئيسية فقط
npx playwright test tests/e2e/home/

# تشغيل اختبارات المنتجات فقط
npx playwright test tests/e2e/products/

# تشغيل اختبارات السلة فقط
npx playwright test tests/e2e/cart/
```

### تشغيل اختبار واحد
```bash
# تشغيل اختبار تسجيل الدخول فقط
npx playwright test tests/e2e/auth/login.e2e.spec.ts

# تشغيل اختبار محدد
npx playwright test tests/e2e/auth/login.e2e.spec.ts -g "تسجيل الدخول"
```

### تشغيل الاختبارات في وضع المراقبة
```bash
npx playwright test --ui
```

## 🔧 خيارات التشغيل

### تشغيل على متصفح محدد
```bash
# تشغيل على Chrome فقط
npx playwright test --project=chromium

# تشغيل على Firefox فقط
npx playwright test --project=firefox

# تشغيل على Safari فقط
npx playwright test --project=webkit
```

### تشغيل على جهاز محدد
```bash
# تشغيل على iPhone
npx playwright test --project="iPhone 12"

# تشغيل على Pixel
npx playwright test --project="Pixel 5"

# تشغيل على iPad
npx playwright test --project="iPad Pro"
```

### خيارات إضافية
```bash
# تشغيل مع إظهار المتصفح
npx playwright test --headed

# تشغيل مع إبطاء العمليات
npx playwright test --debug

# تشغيل مع التقارير
npx playwright test --reporter=html
```

## 📊 التقارير

### تقرير HTML
```bash
npx playwright test --reporter=html
```

### تقرير JSON
```bash
npx playwright test --reporter=json
```

### تقرير JUnit
```bash
npx playwright test --reporter=junit
```

## 🎯 أنواع الاختبارات

### 1. اختبارات المصادقة (`auth/`)
- **تسجيل الدخول**: التحقق من نموذج تسجيل الدخول والتحقق من صحة البيانات
- **التسجيل**: التحقق من نموذج التسجيل وإنشاء الحسابات الجديدة
- **التحقق من الأمان**: اختبار الروابط المحمية وإعادة التوجيه

### 2. اختبارات الصفحة الرئيسية (`home/`)
- **عرض الصفحة**: التحقق من تحميل جميع الأقسام
- **التنقل**: اختبار الروابط والأزرار الرئيسية
- **التصميم المتجاوب**: اختبار عمل الصفحة على جميع الأجهزة
- **الأداء**: قياس أوقات التحميل والاستجابة

### 3. اختبارات التنقل (`navigation/`)
- **القوائم**: اختبار القوائم الرئيسية والفرعية
- **البحث**: اختبار وظيفة البحث والتنقل
- **الروابط**: اختبار جميع الروابط الداخلية والخارجية
- **الاستجابة**: اختبار القوائم المحمولة

### 4. اختبارات المنتجات (`products/`)
- **عرض المنتجات**: التحقق من قائمة المنتجات
- **البحث والفلترة**: اختبار البحث والفلاتر المختلفة
- **التفاصيل**: اختبار صفحات تفاصيل المنتجات
- **السلة**: اختبار إضافة المنتجات للسلة

### 5. اختبارات السلة (`cart/`)
- **إدارة السلة**: إضافة وحذف وتعديل المنتجات
- **الحسابات**: التحقق من حسابات الأسعار والضرائب
- **الدفع**: اختبار عملية الانتقال للدفع
- **الحالة**: اختبار حفظ حالة السلة

## 🎨 اختبارات التصميم

### التصميم المتجاوب
- اختبار أحجام شاشات مختلفة (1920x1080, 1366x768, 1024x768, 768x1024, 375x667, 320x568)
- التحقق من عمل القوائم المحمولة
- اختبار التخطيط على الأجهزة المختلفة

### التصميم RTL
- التحقق من اتجاه النص من اليمين لليسار
- اختبار ترتيب العناصر في التصميم العربي
- التحقق من دعم اللغة العربية

### إمكانية الوصول
- التحقق من وجود alt text للصور
- اختبار labels للحقول
- التحقق من aria-labels
- اختبار التنقل بالكيبورد

## 📱 اختبارات الأجهزة

### أجهزة الكمبيوتر
- **Desktop Large**: 1920x1080
- **Desktop Small**: 1366x768

### الأجهزة اللوحية
- **Tablet Landscape**: 1024x768
- **Tablet Portrait**: 768x1024

### الهواتف
- **Mobile**: 375x667
- **Mobile Small**: 320x568

## 🔍 اختبارات الأداء

### أوقات التحميل
- **الصفحة الرئيسية**: أقل من 5 ثوانٍ
- **صفحة تسجيل الدخول**: أقل من 3 ثوانٍ
- **صفحة المنتجات**: أقل من 5 ثوانٍ
- **صفحة السلة**: أقل من 3 ثوانٍ

### أوقات الاستجابة
- **البحث**: أقل من 3 ثوانٍ
- **إضافة للسلة**: أقل من 2 ثانية
- **فتح السلة**: أقل من ثانيتين
- **الملء النماذج**: أقل من ثانيتين

## 🚨 معالجة الأخطاء

### أنواع الأخطاء
- **أخطاء الشبكة**: انقطاع الاتصال أو بطء الاستجابة
- **أخطاء التحقق**: بيانات غير صحيحة أو مفقودة
- **أخطاء الواجهة**: عناصر غير مرئية أو غير قابلة للنقر
- **أخطاء الأداء**: أوقات تحميل بطيئة

### استراتيجيات المعالجة
- انتظار ظهور العناصر قبل التفاعل معها
- التحقق من وجود العناصر قبل استخدامها
- استخدام timeouts مناسبة للعمليات البطيئة
- التقاط لقطات شاشة عند حدوث أخطاء

## 📸 التقاط الأدلة

### لقطات الشاشة
```bash
# التقاط لقطات شاشة عند حدوث أخطاء
npx playwright test --screenshot=only-on-failure
```

### تسجيل الفيديو
```bash
# تسجيل فيديو للاختبارات
npx playwright test --video=on
```

### التتبع
```bash
# تفعيل التتبع
npx playwright test --trace=on
```

## 🔧 التخصيص

### إعدادات Playwright
يمكن تخصيص إعدادات Playwright في ملف `playwright.config.ts`:

```typescript
export default defineConfig({
  testDir: './tests/e2e',
  fullyParallel: true,
  retries: process.env.CI ? 2 : 0,
  workers: process.env.CI ? 1 : undefined,
  reporter: 'html',
  use: {
    baseURL: 'http://localhost:3000',
    trace: 'on-first-retry',
    screenshot: 'only-on-failure',
    video: 'retain-on-failure',
  },
  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] },
    },
    {
      name: 'firefox',
      use: { ...devices['Desktop Firefox'] },
    },
    {
      name: 'webkit',
      use: { ...devices['Desktop Safari'] },
    },
  ],
});
```

### إعدادات الاختبارات
يمكن تخصيص إعدادات الاختبارات في كل ملف:

```typescript
test.describe('اسم الاختبار', () => {
  test.beforeEach(async ({ page }) => {
    // إعداد مسبق لكل اختبار
  });

  test.afterEach(async ({ page }) => {
    // تنظيف بعد كل اختبار
  });

  test('اسم الاختبار الفرعي', async ({ page }) => {
    // كود الاختبار
  });
});
```

## 🚀 أفضل الممارسات

### كتابة الاختبارات
1. **استخدام أسماء واضحة**: استخدم أسماء تعبر عن الغرض من الاختبار
2. **اختبار واحد لكل وظيفة**: كل اختبار يجب أن يختبر وظيفة واحدة
3. **الاستقلالية**: كل اختبار يجب أن يكون مستقلاً عن الآخرين
4. **التنظيف**: نظف البيانات بعد كل اختبار

### اختيار العناصر
1. **استخدام data-testid**: استخدم data-testid للعناصر المهمة
2. **تجنب CSS classes**: لا تعتمد على CSS classes التي قد تتغير
3. **استخدام النص**: استخدم النص المرئي عند الإمكان
4. **التحقق من الوجود**: تحقق من وجود العناصر قبل استخدامها

### التعامل مع الانتظار
1. **استخدام waitFor**: استخدم waitFor بدلاً من setTimeout
2. **انتظار networkidle**: انتظر انتهاء طلبات الشبكة
3. **timeouts مناسبة**: استخدم timeouts مناسبة لكل عملية
4. **التعامل مع الأخطاء**: تعامل مع الأخطاء بشكل مناسب

## 🐛 استكشاف الأخطاء

### مشاكل شائعة
1. **عناصر غير مرئية**: تأكد من انتظار ظهور العناصر
2. **أخطاء الشبكة**: تحقق من اتصال الشبكة
3. **أخطاء التوقيت**: زد timeouts للعمليات البطيئة
4. **أخطاء المتصفح**: تأكد من تحديث المتصفحات

### أدوات التشخيص
```bash
# تشغيل في وضع التصحيح
npx playwright test --debug

# تشغيل مع إظهار المتصفح
npx playwright test --headed

# تشغيل مع إبطاء العمليات
npx playwright test --debug
```

## 📚 موارد إضافية

### وثائق Playwright
- [Playwright Documentation](https://playwright.dev/)
- [Playwright API Reference](https://playwright.dev/docs/api/class-playwright)
- [Playwright Best Practices](https://playwright.dev/docs/best-practices)

### أمثلة وتطبيقات
- [Playwright Examples](https://github.com/microsoft/playwright/tree/main/examples)
- [Playwright Test Examples](https://github.com/microsoft/playwright/tree/main/tests)

### المجتمع والدعم
- [Playwright GitHub](https://github.com/microsoft/playwright)
- [Playwright Discord](https://discord.gg/playwright)

## 🤝 المساهمة

### إضافة اختبارات جديدة
1. أنشئ ملف جديد في المجلد المناسب
2. اتبع نمط التسمية الموجود
3. أضف اختبارات شاملة
4. تأكد من عمل الاختبارات على جميع المتصفحات

### تحسين الاختبارات الموجودة
1. حدد الاختبارات البطيئة
2. حسّن اختيار العناصر
3. أضف اختبارات إضافية
4. حسّن رسائل الخطأ

### الإبلاغ عن الأخطاء
1. وصف المشكلة بوضوح
2. أضف خطوات إعادة الإنتاج
3. أرفق لقطات شاشة أو تسجيلات
4. حدد المتصفح ونظام التشغيل

## 📈 المقاييس والأهداف

### أهداف التغطية
- **المصادقة**: 100% تغطية لجميع وظائف المصادقة
- **التنقل**: 100% تغطية لجميع الروابط والقوائم
- **المنتجات**: 100% تغطية لجميع وظائف المنتجات
- **السلة**: 100% تغطية لجميع وظائف السلة

### أهداف الأداء
- **وقت التحميل**: أقل من 5 ثوانٍ لجميع الصفحات
- **وقت الاستجابة**: أقل من 3 ثوانٍ لجميع العمليات
- **الاستقرار**: 99%+ نجاح في الاختبارات

### أهداف الجودة
- **إمكانية الوصول**: توافق كامل مع معايير WCAG
- **التصميم المتجاوب**: عمل مثالي على جميع الأجهزة
- **دعم RTL**: دعم كامل للغة العربية

---

## 🎉 الخلاصة

اختبارات E2E هذه توفر تغطية شاملة لتطبيق Kaleem Frontend، مما يضمن عمل جميع الميزات بشكل صحيح من وجهة نظر المستخدم النهائي. هذه الاختبارات تساعد في:

- **اكتشاف الأخطاء مبكراً**: قبل وصولها للمستخدمين
- **ضمان الجودة**: التأكد من عمل جميع الميزات
- **تحسين الأداء**: قياس وتحسين أوقات الاستجابة
- **دعم التطوير**: اختبار التغييرات الجديدة
- **الوثائق**: توثيق كيفية عمل التطبيق

استخدم هذه الاختبارات بانتظام لضمان جودة تطبيقك وتوفير تجربة مستخدم ممتازة! 🚀
